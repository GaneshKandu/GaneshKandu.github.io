<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>About Me ( Ganesh Kandu )</title>

<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/highlight.js/styles/github.min.css">

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  max-width: 900px;
  margin: 40px auto;
  padding: 0 16px;
  line-height: 1.6;
}
pre { padding: 12px; overflow-x: auto; }
code { background: #f6f8fa; padding: 2px 4px; border-radius: 4px; }
</style>
</head>

<body>

<div id="content">Loading…</div>

<script src="https://cdn.jsdelivr.net/npm/markdown-it@13/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/highlight.js@11/lib/common.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>

<script>
const md = markdownit({
  html: true,
  linkify: true,
  typographer: true,
  highlight: (str, lang) => {
    if (lang && hljs.getLanguage(lang)) {
      return '<pre class="hljs"><code>' +
        hljs.highlight(str, { language: lang }).value +
        '</code></pre>';
    }
    return '<pre class="hljs"><code>' +
      md.utils.escapeHtml(str) +
      '</code></pre>';
  }
});

function resolveMarkdownFromHash() {
  const hash = location.hash.replace(/^#/, '');

  // 1️⃣ No hash → README.md
  if (!hash) return 'README.md';

  // 2️⃣ #project-a.exp → project-a/exp.md
  if (hash.includes('.')) {
    const [folder, file] = hash.split('.', 2);
    return `${folder}/${file}.md`;
  }

  // 3️⃣ #project-a → project-a.md
  return `${hash}.md`;
}

function loadMarkdown() {
  const mdPath = resolveMarkdownFromHash();

  fetch(mdPath)
    .then(res => {
      if (!res.ok) throw new Error('Not found');
      return res.text();
    })
    .then(text => {
      document.getElementById('content').innerHTML =
        DOMPurify.sanitize(md.render(text));
    })
    .catch(() => {
      document.getElementById('content').innerHTML =
        `<h2>404</h2><p>${mdPath} not found</p>`;
    });
}

window.addEventListener('hashchange', loadMarkdown);
loadMarkdown();
</script>

</body>
</html>
