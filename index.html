<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hi, I’m Ganesh Kandu</title>

<!-- Highlight.js CSS (correct CDN) -->
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/styles/github.min.css">

<!-- KaTeX CSS -->
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  max-width: 900px;
  margin: 40px auto;
  padding: 0 16px;
  line-height: 1.6;
}
pre { padding: 12px; overflow-x: auto; }
code { background: #f6f8fa; padding: 2px 4px; border-radius: 4px; }
.katex { font-size: 1em; }
</style>
</head>
<body>

<div id="content">Loading…</div>

<!-- Libraries -->
<script src="https://cdn.jsdelivr.net/npm/markdown-it@13/dist/markdown-it.min.js"></script>

<!-- Highlight.js (correct CDN) -->
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>

<!-- KaTeX + auto-render -->
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/markdown-it-attrs/dist/markdown-it-attrs.min.js"></script>

<script>
const md = markdownit({
  html: true,
  linkify: true,
  typographer: true,
  highlight: (str, lang) => {
    if (lang && hljs.getLanguage(lang)) {
      return '<pre class="hljs"><code>' +
        hljs.highlight(str, { language: lang }).value +
        '</code></pre>';
    }
    return '<pre class="hljs"><code>' +
      md.utils.escapeHtml(str) +
      '</code></pre>';
  }
});

function resolveMarkdownFromHash() {
  const hash = location.hash.replace(/^#/, '');
  if (!hash) return 'README.md';
  if (hash.includes('.')) {
    const [folder, file] = hash.split('.', 2);
    return `${folder}/${file}.md`;
  }
  return `${hash}.md`;
}

function loadMarkdown() {
  const mdPath = resolveMarkdownFromHash();
  fetch(mdPath)
    .then(res => {
      if (!res.ok) throw new Error('Not found');
      return res.text();
    })
    .then(text => {
      document.getElementById('content').innerHTML =
        DOMPurify.sanitize(md.render(text));

      // Math
      if (window.renderMathInElement) {
        try {
          renderMathInElement(document.getElementById('content'), {
            delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false}
            ],
            throwOnError: false,
            ignoredTags: ['script','noscript','style','textarea','pre','code']
          });
        } catch (e) {
          console.warn('KaTeX render error', e);
        }
      }

      // Highlight all
      document.querySelectorAll('pre code').forEach(block => hljs.highlightElement(block));
    })
    .catch((e) => {
      document.getElementById('content').innerHTML =
        `<h2>404</h2><p>${mdPath} not found</p>`;
        console.log('KaTeX render error', e);
    });
}

window.addEventListener('hashchange', loadMarkdown);
loadMarkdown();
</script>

</body>
</html>
