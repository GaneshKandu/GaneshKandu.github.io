<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hi, I‚Äôm Ganesh Kandu</title>

<!-- Highlight.js CSS -->
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/styles/github.min.css">

<!-- KaTeX CSS -->
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">

<style>
/* =====================
   THEME VARIABLES
===================== */
:root {
  --bg: #ffffff;
  --text: #24292f;
  --code-bg: #f6f8fa;
  --border: #d0d7de;
}

[data-theme="dark"] {
  --bg: #0d1117;
  --text: #c9d1d9;
  --code-bg: #161b22;
  --border: #30363d;
}

/* =====================
   BASE STYLES
===================== */
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  max-width: 900px;
  margin: 40px auto;
  padding: 0 16px;
  line-height: 1.6;
  background: var(--bg);
  color: var(--text);
}

pre {
  padding: 12px;
  overflow-x: auto;
  background: var(--code-bg);
  border-radius: 6px;
}

code {
  background: var(--code-bg);
  padding: 2px 4px;
  border-radius: 4px;
}

.katex {
  font-size: 1em;
}

/* =====================
   THEME TOGGLE
===================== */
#theme-toggle {
  position: fixed;
  top: 16px;
  right: 16px;
  background: var(--code-bg);
  border: 1px solid var(--border);
  border-radius: 999px;
  padding: 6px 10px;
  cursor: pointer;
  font-size: 14px;
}
</style>
</head>

<body>

<button id="theme-toggle" aria-label="Toggle theme">üåô</button>
<div id="content">Loading‚Ä¶</div>

<!-- =====================
     LIBRARIES
===================== -->
<script src="https://cdn.jsdelivr.net/npm/markdown-it@13/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>

<!-- KaTeX -->
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/markdown-it-attrs/dist/markdown-it-attrs.min.js"></script>

<script>
/* =====================
   MARKDOWN SETUP
===================== */
const md = markdownit({
  html: true,
  linkify: true,
  typographer: true,
  highlight: (str, lang) => {
    if (lang && hljs.getLanguage(lang)) {
      return '<pre class="hljs"><code>' +
        hljs.highlight(str, { language: lang }).value +
        '</code></pre>';
    }
    return '<pre class="hljs"><code>' +
      md.utils.escapeHtml(str) +
      '</code></pre>';
  }
});

/* =====================
   MARKDOWN ROUTING
===================== */
function resolveMarkdownFromHash() {
  const hash = location.hash.replace(/^#/, '');
  if (!hash) return 'README.md';
  if (hash.includes('.')) {
    const [folder, file] = hash.split('.', 2);
    return `${folder}/${file}.md`;
  }
  return `${hash}.md`;
}

function loadMarkdown() {
  const mdPath = resolveMarkdownFromHash();
  fetch(mdPath)
    .then(res => {
      if (!res.ok) throw new Error('Not found');
      return res.text();
    })
    .then(text => {
      document.getElementById('content').innerHTML =
        DOMPurify.sanitize(md.render(text));

      // KaTeX render
      if (window.renderMathInElement) {
        renderMathInElement(document.getElementById('content'), {
          delimiters: [
            { left: '$$', right: '$$', display: true },
            { left: '$', right: '$', display: false }
          ],
          throwOnError: false,
          ignoredTags: ['script','noscript','style','textarea','pre','code']
        });
      }

      // Highlight.js
      document.querySelectorAll('pre code')
        .forEach(block => hljs.highlightElement(block));
    })
    .catch(() => {
      document.getElementById('content').innerHTML =
        `<h2>404</h2><p>${mdPath} not found</p>`;
    });
}

window.addEventListener('hashchange', loadMarkdown);
loadMarkdown();

/* =====================
   THEME TOGGLE LOGIC
===================== */
(function () {
  const root = document.documentElement;
  const toggle = document.getElementById('theme-toggle');

  const saved = localStorage.getItem('theme');
  const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

  if (saved) {
    root.setAttribute('data-theme', saved);
  } else if (systemDark) {
    root.setAttribute('data-theme', 'dark');
  }

  updateIcon();

  toggle.addEventListener('click', () => {
    const isDark = root.getAttribute('data-theme') === 'dark';
    root.setAttribute('data-theme', isDark ? 'light' : 'dark');
    localStorage.setItem('theme', isDark ? 'light' : 'dark');
    updateIcon();
  });

  function updateIcon() {
    toggle.textContent =
      root.getAttribute('data-theme') === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  }
})();
</script>

</body>
</html>
